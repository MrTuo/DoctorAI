{% load staticfiles %}
<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="wuwujun">

    <title>在线诊疗-心脏病</title>
    <link rel="stylesheet" type="text/css" href="{% static 'AiServer/css/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'AiServer/css/font-awesome.min.css' %}">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Catamaran:800,300,100">
    <link rel='stylesheet' href='{% static 'AiServer/css/index_mb.css' %}'>

  </head>
  <body>
    <header>
      <nav class="navbar navbar-default navbar-fixed-top my-navbar" role="navigation">
        <div class="container-fluid container my-nav">
          <div class="navbar-header">
            <Button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#menu">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </Button>
            <span class="navbar-brand">医疗诊断系统</span>
          </div>
          <div id="menu" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right my-navbar-menu">
              <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="" role="button"
                   aria-haspopup="true" aria-expanded="false">
                    查询疾病类型 <span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                    <li>
                        <a href="/check-inf-post/1/?from=mobile">心脏病</a>
                    </li>
                    <li>
                        <a href="/check-inf-post/2/?from=mobile">慢性肾炎</a>
                    </li>
                </ul>
            </li>
              <li>
                <a href="/all-result/?from=mobile">返回</a>
              </li>
              <li>
                <a href="/logout/?from=mobile">登出</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    
    <!-- main content start-->
    <section id="user-details">
      <div id="user-details-section">
        <div class="container">
          <div class="row">
            <div class="panel panel-info">
              <div class="panel-heading">
                <h4 class="panel-title">心脏病——各项指标</h4>
              </div>
              <div class="panel-body">
                <form action="." id="postForm" class="form-horizontal" role="form" method="post" onsubmit="return false">
                  <div class="form-group">
                    <label class="col-sm-2 control-label">年龄</label>
                    <div class="col-sm-4">
                      <input type="number" class="form-control" name="age" min="1" max="120" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">性别</label>
                    <div class="col-sm-10">
                      <label class="radio-inline">
                        <input type="radio" name="sex" value="1" checked>女
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="sex" value="0">男
                      </label>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">胸部疼痛类型</label>
                    <div class="col-sm-10">
                      <label class="radio-inline">
                        <input type="radio" name="cp" value="1" checked>典型心绞痛
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="cp" value="2">非典型心绞痛
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="cp" value="3">非心绞痛
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="cp" value="4">无临床症状
                      </label>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">安静血压</label>
                    <div class="col-sm-4">
                      <input type="number" class="form-control" name="tresbps" placeholder="xx-mmHg" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">血清类固醇</label>
                    <div class="col-sm-4">
                      <input type="number" class="form-control" name="chol" placeholder="xx-mg/dl" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">空腹血糖</label>
                    <div class="col-sm-4">
                      <input type="number" class="form-control" name="fbs" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">静息心电图结果</label>
                    <div class="col-sm-10">
                      <label class="radio-inline">
                        <input type="radio" name="restecg" value="0" checked>正常
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="restecg" value="1">拥有ST-T畸形波
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="restecg" value="2">显示可能或明确的左心室肥厚
                      </label>
                    </div>
                  </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">最大心率</label>
                        <div class="col-sm-4">
                            <input type="number" class="form-control" name="thalach" required>
                        </div>
                    </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">是否为运动诱发的心绞痛</label>
                    <div class="col-sm-10">
                      <label class="radio-inline">
                        <input type="radio" name="exang" value="0" checked>是
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="exang" value="1">否
                      </label>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">运动相对于休息引起的ST抑郁症</label>
                    <div class="col-sm-4">
                      <input type="number" class="form-control" name="oldpeak" placeholder="0.0-9.0" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">峰值运动ST段的斜率</label>
                    <div class="col-sm-10">
                      <label class="radio-inline">
                        <input type="radio" name="slope" value="1" checked>上涨
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="slope" value="2">瓶
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="slope" value="3">下坡
                      </label>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">主要血管数量</label>
                    <div class="col-sm-4">
                      <input type="number" class="form-control" name="ca" placeholder="0-3" required>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">Thal</label>
                    <div class="col-sm-10">
                      <label class="radio-inline">
                        <input type="radio" name="thal" value="3" checked>正常
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="thal" value="6">固定缺陷
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="thal" value="7">可逆缺陷
                      </label>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label">您是否同意我们使用您的数据？</label>
                    <div class="col-sm-10">
                      <label class="radio-inline">
                        <input type="radio" name="user_agree" value="0" checked>同意
                      </label>
                      <label class="radio-inline">
                        <input type="radio" name="user_agree" value="1">不同意
                      </label>
                    </div>
                      <input type="hidden" name="type" value="1">
                      <input type="hidden" name="device" value="mobile">
                  </div>
                  <div class="form-group">
                    <p class="col-sm-2 text-success">数据只包括病情信息，不包含您的姓名等隐私。</p>
                    <p class="col-sm-2 text-success">我们承诺不会将数据泄露给第三方。</p>
                      <p class="col-sm-2 text-success">如果您选择不同意，我们会对您的填写数据进行模糊处理，但是可能会造成预测结果失准</p>
                  </div>
                  <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                      <Button id="submitBtn" class="btn btn-primary" type="submit">提交</Button>
                    </div>
                  </div>              
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>



    <script type="text/javascript" src="{% static 'AiServer/js/jquery-2.1.4.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'AiServer/js/bootstrap.min.js' %}"></script>
    <script type="text/javascript">
function getNumberInNormalDistribution(mean, std_dev){
           return mean + (uniform2NormalDistribution() * std_dev);
        }

        function uniform2NormalDistribution(){
          var sum = 0.0;
          for(var i = 0; i < 12; i++) {
            sum = sum + Math.random();
          }
          return sum - 6.0;
        }

        function obfuscation(form) {

          for (var i = 0; i < form.elements.length; i++) {
            if (form.elements[i].type == "number") {
              var temp = Number(form.elements[i].value) + getNumberInNormalDistribution(0.5, 0.1);
              form.elements[i].value = temp.toString();
            }
          }
        }

         $('#submitBtn').click(function() {
          var form = document.getElementById("postForm");
          var val = $('input:radio[name="user_agree"]:checked').val();
          if (val == "1") {
            obfuscation(form);
          }
          form.submit();
        });
    </script>



  </body>
</html>
